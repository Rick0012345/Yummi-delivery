{% extends "base.html" %}

{% block title %}Configurações - Lanchonete{% endblock %}
{% load static %}

{% block content %}
<!-- Mensagens de feedback -->
{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endfor %}
{% endif %}

<div class="row">
    <div class="col-lg-6">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Informações da Lanchonete</h6>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="informacoes">
                    <div class="mb-3">
                        <label for="nome" class="form-label">Nome da Lanchonete</label>
                        <input type="text" class="form-control" id="nome" name="nome" value="{{ lanchonete.nome }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="cnpj" class="form-label">CNPJ</label>
                        <input type="text" class="form-control" id="cnpj" name="cnpj" value="{{ lanchonete.cnpj }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="telefone" class="form-label">Telefone</label>
                        <input type="tel" class="form-control" id="telefone" name="telefone" value="{{ lanchonete.telefone }}" required>
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">E-mail</label>
                        <input type="email" class="form-control" id="email" name="email" value="{{ lanchonete.email }}" required>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-8">
                            <label for="endereco" class="form-label">Endereço</label>
                            <input type="text" class="form-control" id="endereco" name="endereco" value="{{ lanchonete.endereco }}" required>
                        </div>
                        <div class="col-md-4">
                            <label for="numero" class="form-label">Número</label>
                            <input type="text" class="form-control" id="numero" name="numero" value="{{ lanchonete.numero }}">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="bairro" class="form-label">Bairro</label>
                            <input type="text" class="form-control" id="bairro" name="bairro" value="{{ lanchonete.bairro }}" required>
                        </div>
                        <div class="col-md-4">
                            <label for="cidade" class="form-label">Cidade</label>
                            <input type="text" class="form-control" id="cidade" name="cidade" value="{{ lanchonete.cidade }}" required>
                        </div>
                        <div class="col-md-2">
                            <label for="estado" class="form-label">UF</label>
                            <input type="text" class="form-control" id="estado" name="estado" value="{{ lanchonete.estado }}" maxlength="2" required>
                        </div>
                        <div class="col-md-2">
                            <label for="cep" class="form-label">CEP</label>
                            <input type="text" class="form-control" id="cep" name="cep" value="{{ lanchonete.cep }}" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="logo" class="form-label">Logo</label>
                        <input class="form-control" type="file" id="logo" name="logo" accept="image/*">
                        {% if lanchonete.logo %}
                        <div class="mt-2">
                            <img src="{{ lanchonete.logo.url }}" alt="Logo atual" class="img-thumbnail" style="max-width: 150px;">
                        </div>
                        {% endif %}
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">Salvar Informações</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-lg-6">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Configurações de Entrega</h6>
            </div>
            <div class="card-body">
                <form method="post">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="entrega">
                    <div class="mb-3">
                        <label for="taxa_entrega" class="form-label">Taxa de Entrega (R$)</label>
                        <input type="number" class="form-control" id="taxa_entrega" name="taxa_entrega" value="{{ lanchonete.taxa_entrega }}" step="0.01" min="0" required>
                    </div>
                    <div class="mb-3">
                        <label for="tempo_estimado" class="form-label">Tempo Estimado de Entrega (minutos)</label>
                        <input type="number" class="form-control" id="tempo_estimado" name="tempo_estimado" value="{{ lanchonete.tempo_estimado }}" min="1" required>
                    </div>
                    <div class="mb-3">
                        <label for="raio_entrega" class="form-label">Raio de Entrega (km)</label>
                        <input type="number" class="form-control" id="raio_entrega" name="raio_entrega" value="{{ lanchonete.raio_entrega }}" step="0.1" min="0" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Dias de Funcionamento</label>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="segunda" name="segunda" {% if 'segunda' in dias_funcionamento %}checked{% endif %}>
                                    <label class="form-check-label" for="segunda">Segunda-feira</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="terca" name="terca" {% if 'terca' in dias_funcionamento %}checked{% endif %}>
                                    <label class="form-check-label" for="terca">Terça-feira</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="quarta" name="quarta" {% if 'quarta' in dias_funcionamento %}checked{% endif %}>
                                    <label class="form-check-label" for="quarta">Quarta-feira</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="quinta" name="quinta" {% if 'quinta' in dias_funcionamento %}checked{% endif %}>
                                    <label class="form-check-label" for="quinta">Quinta-feira</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="sexta" name="sexta" {% if 'sexta' in dias_funcionamento %}checked{% endif %}>
                                    <label class="form-check-label" for="sexta">Sexta-feira</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="sabado" name="sabado" {% if 'sabado' in dias_funcionamento %}checked{% endif %}>
                                    <label class="form-check-label" for="sabado">Sábado</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="domingo" name="domingo" {% if 'domingo' in dias_funcionamento %}checked{% endif %}>
                                    <label class="form-check-label" for="domingo">Domingo</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="horario_abertura" class="form-label">Horário de Abertura</label>
                            <input type="time" class="form-control" id="horario_abertura" name="horario_abertura" value="{% if lanchonete.horario_abertura %}{{ lanchonete.horario_abertura|time:'H:i' }}{% endif %}">
                        </div>
                        <div class="col-md-6">
                            <label for="horario_fechamento" class="form-label">Horário de Fechamento</label>
                            <input type="time" class="form-control" id="horario_fechamento" name="horario_fechamento" value="{% if lanchonete.horario_fechamento %}{{ lanchonete.horario_fechamento|time:'H:i' }}{% endif %}">
                        </div>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">Salvar Configurações</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-6">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Formas de Pagamento</h6>
            </div>
            <div class="card-body">
                <form method="post">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="pagamento">
                    <div class="mb-3">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="pix" name="pix" {% if lanchonete.pix %}checked{% endif %}>
                            <label class="form-check-label" for="pix">PIX</label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="chave_pix" class="form-label">Chave PIX</label>
                        <input type="text" class="form-control" id="chave_pix" name="chave_pix" value="{{ lanchonete.chave_pix|default:'' }}" placeholder="Digite sua chave PIX">
                        <div class="form-text">Pode ser CPF, CNPJ, e-mail, telefone ou chave aleatória</div>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">Salvar Formas de Pagamento</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-lg-6">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Usuários do Sistema</h6>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered table-hover" width="100%" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Usuário</th>
                                <th>Perfil</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Administrador</td>
                                <td>admin</td>
                                <td>Administrador</td>
                                <td>
                                    <button class="btn btn-sm btn-info">
                                        <i class="bi bi-pencil"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>Atendente</td>
                                <td>atendente</td>
                                <td>Atendente</td>
                                <td>
                                    <button class="btn btn-sm btn-info">
                                        <i class="bi bi-pencil"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>Cozinheiro</td>
                                <td>cozinha</td>
                                <td>Cozinha</td>
                                <td>
                                    <button class="btn btn-sm btn-info">
                                        <i class="bi bi-pencil"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="d-grid mt-3">
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#novoUsuarioModal">
                        <i class="bi bi-plus-circle me-1"></i> Novo Usuário
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Novo Usuário -->
<div class="modal fade" id="novoUsuarioModal" tabindex="-1" aria-labelledby="novoUsuarioModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="novoUsuarioModalLabel">Novo Usuário</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="nomeUsuario" class="form-label">Nome Completo</label>
                        <input type="text" class="form-control" id="nomeUsuario" required>
                    </div>
                    <div class="mb-3">
                        <label for="loginUsuario" class="form-label">Login</label>
                        <input type="text" class="form-control" id="loginUsuario" required>
                    </div>
                    <div class="mb-3">
                        <label for="emailUsuario" class="form-label">E-mail</label>
                        <input type="email" class="form-control" id="emailUsuario" required>
                    </div>
                    <div class="mb-3">
                        <label for="senhaUsuario" class="form-label">Senha</label>
                        <input type="password" class="form-control" id="senhaUsuario" required>
                    </div>
                    <div class="mb-3">
                        <label for="confirmarSenha" class="form-label">Confirmar Senha</label>
                        <input type="password" class="form-control" id="confirmarSenha" required>
                    </div>
                    <div class="mb-3">
                        <label for="perfilUsuario" class="form-label">Perfil</label>
                        <select class="form-select" id="perfilUsuario" required>
                            <option value="">Selecione um perfil</option>
                            <option value="admin">Administrador</option>
                            <option value="atendente">Atendente</option>
                            <option value="cozinha">Cozinha</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary">Salvar</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
